<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-10-25">

<title>ADA511 0.1 Data science and data-driven engineering - 32&nbsp; The Dirichlet-mixture belief distribution</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./prototype_code.html" rel="next">
<link href="./summary_formulae.html" rel="prev">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="ada511styles.css">
</head>

<body class="nav-sidebar docked slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./dirichlet-mixture.html"><span class="red"><strong>An Optimal Predictor Machine</strong></span></a></li><li class="breadcrumb-item"><a href="./dirichlet-mixture.html"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">[The Dirichlet-mixture belief distribution]{.red}</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./ada511logo8_small.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">ADA511 <span class="small grey">0.1</span> <br><span class="small grey">updated 2023-10-25</span></a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dear student<br> and aspiring data engineer</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text"><strong>An invitation</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Accept or discard?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./framework.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Framework</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic_decisions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Basic decision problems</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./connection-1-ML.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title"><span class="red">First connection with machine learning</span></span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text"><span class="green"><strong>Inference I</strong></span></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title"><span class="green">What is an inference?</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sentences.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title"><span class="green">Sentences</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./truth_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title"><span class="green">Truth inference</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title"><span class="green">Probability inference</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./derived_rules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title"><span class="green">Shortcut rules</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./monty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title"><span class="green">Monty Hall and related inference problems</span></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./connection-2-ML.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title"><span class="red">Second connection with machine learning</span></span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text"><span class="yellow"><strong>Data I</strong></span></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quantities_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title"><span class="yellow">Quantities and data types</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quantities_types_multi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title"><span class="yellow">Joint quantities and complex data types</span></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text"><span class="green"><strong>Inference II</strong></span></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title"><span class="green">Probability distributions</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./joint_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title"><span class="green">Joint probability distributions</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./marginal_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title"><span class="green">Marginal probability distributions</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conditional_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title"><span class="green">Conditional probability and learning</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./information.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title"><span class="green">Information, relevance, independence, association</span></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./connection-3-ML.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title"><span class="red">Third connection with machine learning</span></span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text"><span class="yellow"><strong>Data II</strong></span></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./populations_variates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title"><span class="yellow">Populations and variates</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title"><span class="yellow">Statistics</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./subpopulations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title"><span class="yellow">Subpopulations and conditional frequencies</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title"><span class="yellow">Infinite populations and samples</span></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text"><span class="red"><strong>Machine learning</strong></span></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./machine_learning_overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Introduction to machine learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./decision_trees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./neural_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./beyond-ML.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title"><span class="red">Beyond machine learning</span></span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text"><span class="green"><strong>Inference III</strong></span></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exchangeable_probabilities.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title"><span class="green">Exchangeable beliefs</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_from_freqs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title"><span class="green">Inferences from frequencies</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_about_freqs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title"><span class="green">Inference about frequencies</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary_formulae.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title"><span class="green">Final inference formulae</span></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text"><span class="red"><strong>An Optimal Predictor Machine</strong></span></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dirichlet-mixture.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title"><span class="red">The Dirichlet-mixture belief distribution</span></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prototype_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title"><span class="red">Code and computations</span></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text"><span class="lightblue"><strong>Decision theory</strong></span></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./making_decisions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title"><span class="blue">The omnipresence of decision-making in machine learning</span></span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-intro-dirichlet-mix" id="toc-sec-intro-dirichlet-mix" class="nav-link active" data-scroll-target="#sec-intro-dirichlet-mix"><span class="header-section-number">32.1</span> A belief distribution for frequency distributions over nominal variates</a></li>
  <li><a href="#sec-joint-prob-dirichlet" id="toc-sec-joint-prob-dirichlet" class="nav-link" data-scroll-target="#sec-joint-prob-dirichlet"><span class="header-section-number">32.2</span> Joint probabilities about units with the Dirichlet-mixture distribution</a></li>
  <li><a href="#sec-formulae-with-Dirmix" id="toc-sec-formulae-with-Dirmix" class="nav-link" data-scroll-target="#sec-formulae-with-Dirmix"><span class="header-section-number">32.3</span> Main inference formulae with the Dirichlet-mixture belief distribution</a></li>
  <li><a href="#sec-dirmix-example1" id="toc-sec-dirmix-example1" class="nav-link" data-scroll-target="#sec-dirmix-example1"><span class="header-section-number">32.4</span> Example&nbsp;1: Forecast about one variate, given previous observations</a></li>
  <li><a href="#sec-dirmix-example2" id="toc-sec-dirmix-example2" class="nav-link" data-scroll-target="#sec-dirmix-example2"><span class="header-section-number">32.5</span> Example&nbsp;2: Forecast about one predictand, given predictor and previous observations</a></li>
  <li><a href="#sec-critique-dirmix" id="toc-sec-critique-dirmix" class="nav-link" data-scroll-target="#sec-critique-dirmix"><span class="header-section-number">32.6</span> When is the Dirichlet-mixture belief distribution appropriate?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-dirichlet-mix" class="quarto-section-identifier"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title"><span class="red">The Dirichlet-mixture belief distribution</span></span></span></h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2023-10-25</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="hidden">
<p><span class="math display">\[
\DeclarePairedDelimiters{\set}{\{}{\}}
\DeclareMathOperator*{\argmax}{arg\,max}
\]</span></p>
</div>
<div class="hidden">

</div>
<div class="hidden">

</div>
<div class="hidden">

</div>
<section id="sec-intro-dirichlet-mix" class="level2 page-columns page-full" data-number="32.1">
<h2 data-number="32.1" class="anchored" data-anchor-id="sec-intro-dirichlet-mix"><span class="header-section-number">32.1</span> A belief distribution for frequency distributions over nominal variates</h2>
<p>In this course we sadly shall not examine in depth any mathematical expressions for belief distributions <span style="display:inline-block;"><span class="math inline">\(\mathrm{P}(F\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}\boldsymbol{f}\nonscript\:\vert\nonscript\:\mathopen{}\mathsfit{I})\)</span></span> over frequencies. We briefly discuss here one belief distribution that is used in the prototype “optimal predictor machine” applied in the following chapters. We call it the <span class="blue"><strong>Dirichlet-mixture</strong></span> belief distribution. The state of knowledge underlying this distribution will be denoted <span style="display:inline-block;"><span class="math inline">\(\mathsfit{D}\)</span>.</span></p>
<p>The Dirichlet-mixture distribution is appropriate for frequency distributions over discrete, <em>nominal</em> variates, or joint variates with all nominal components. It is not appropriate to discrete ordinal variates, because it implicitly assumes that there is no natural order to the variate values.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="fa-solid fa-rocket" aria-label="rocket"></i> For the extra curious
</div>
</div>
<div class="callout-body-container callout-body">
<p>Some of the theoretical basis for the choice of this belief distribution can be found in chapters&nbsp;4–5 of <a href="https://hvl.instructure.com/courses/25074/modules/items/720141"><em>The Estimation of Probabilities</em></a>.</p>
</div>
</div>
</div></div><p>Suppose we have a simple or joint nominal variate <span style="display:inline-block;"><span class="math inline">\({\color[RGB]{68,119,170}Z}\)</span></span> which can assume <span style="display:inline-block;"><span class="math inline">\(M\)</span></span> different values (these can be joint values, as in the examples of <a href="inference_from_freqs.html#sec-know-freq">§ &nbsp;<span>29.2</span></a>). As usual <span style="display:inline-block;"><span class="math inline">\(\boldsymbol{f}\)</span></span> denotes a specific frequency distribution for the variate values. For a specific value <span style="display:inline-block;"><span class="math inline">\({\color[RGB]{68,119,170}z}\)</span>,</span> <span style="display:inline-block;"><span class="math inline">\(f({\color[RGB]{68,119,170}z})\)</span></span> is the relative frequency with which that value occurs in the full population.</p>
<p>The Dirichlet-mixture distribution assigns to <span style="display:inline-block;"><span class="math inline">\(\boldsymbol{f}\)</span></span> a probability density given by the following formula:</p>
<p><span class="math display">\[\mathrm{p}(F\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}\boldsymbol{f}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D}) =
\frac{1}{1+k_{\text{max}}-k_{\text{min}}}
\sum_{k=k_{\text{min}}}^{k_{\text{max}}}
\Biggl[\prod_{{\color[RGB]{68,119,170}z}} f({\color[RGB]{68,119,170}z})^{2^k-1} \Biggr]
\cdot
\frac{
\bigl(M\,2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^M
}
\]</span></p>
<p>Besides some multiplicative constants, the probability is simply proportional to the product of all frequencies, raised to some powers.</p>
<p>The product <span style="display:inline-block;">“<span class="math inline">\(\prod_{{\color[RGB]{68,119,170}z}}\)</span>”</span> is over all <span style="display:inline-block;"><span class="math inline">\(M\)</span></span> possible values of <span style="display:inline-block;"><span class="math inline">\({\color[RGB]{68,119,170}Z}\)</span>.</span> The sum <span style="display:inline-block;">“<span class="math inline">\(\sum_{k}\)</span>”</span> is over an <em>integer</em> (positive or negative) parameter <span style="display:inline-block;"><span class="math inline">\(k\)</span></span> that runs between a minimum and maximum value. In the applications of the next chapters the values are chosen as follows:</p>
<p><span class="math display">\[
2^{k_{\text{min}}} \approx \frac{1}{M}
\qquad
2^{k_{\text{max}}} = 4
\]</span></p>
<p>In most applications it does not matter if we take a lower <span style="display:inline-block;"><span class="math inline">\(k_{\text{min}}\)</span></span> or a higher <span style="display:inline-block;"><span class="math inline">\(k_{\text{max}}\)</span>.</span></p>
<p><br>
</p>
<p>Let’s see how this formula concretely looks like in the simple example of the Mars-prospecting scenario (which had many analogies with coin tosses).</p>
<p>The variate <span style="display:inline-block;"><span class="math inline">\(R\)</span></span> can assume two values <span style="display:inline-block;"><span class="math inline">\(\set{{\color[RGB]{102,204,238}{\small\verb;Y;}},{\color[RGB]{204,187,68}{\small\verb;N;}}}\)</span>,</span> so <span style="display:inline-block;"><span class="math inline">\(M=2\)</span></span> in this case. The frequency distribution consists in two frequencies:</p>
<p><span class="math display">\[f({\color[RGB]{102,204,238}{\small\verb;Y;}}) \qquad f({\color[RGB]{204,187,68}{\small\verb;N;}})\]</span></p>
<p>of which only one can be chosen independently, since they must sum up to 1.</p>
<p>Then</p>
<p><span class="math display">\[
2^{k_{\text{min}}} \approx \frac{1}{2}\ ,
\quad
2^{k_{\text{max}}} = 4
\qquad\Longrightarrow\qquad
k_{\text{min}}= -1 \ ,
\quad
k_{\text{max}}= 2
\]</span></p>
<p>and the agent’s belief distribution for the frequencies is</p>
<p><span class="math display">\[
\begin{aligned}
\mathrm{p}(F\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}\boldsymbol{f}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D}) &amp;=
\frac{1}{1+k_{\text{max}}-k_{\text{min}}}
\sum_{k=-1}^{2}
\Biggl[\prod_{{\color[RGB]{68,119,170}z}} f({\color[RGB]{68,119,170}z})^{2^k-1} \Biggr]
\cdot
\frac{
\bigl(2\cdot 2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^2
}
\\[2ex]
&amp;=
\frac{1}{1+2+1}
\Biggl[
f({\color[RGB]{102,204,238}{\small\verb;Y;}})^{2^{-1}-1}\cdot f({\color[RGB]{204,187,68}{\small\verb;N;}})^{2^{-1}-1}
\cdot
\frac{
\bigl(2\cdot 2^{-1} -1 \bigr)!
}{
{\bigl(2^{-1} - 1\bigr)!}^2
}
+{} \\&amp;\qquad
f({\color[RGB]{102,204,238}{\small\verb;Y;}})^{2^{0}-1}\cdot f({\color[RGB]{204,187,68}{\small\verb;N;}})^{2^{0}-1}
\cdot
\frac{
\bigl(2\cdot 2^{0} -1 \bigr)!
}{
{\bigl(2^{0} - 1\bigr)!}^2
}
+{} \\&amp;\qquad
f({\color[RGB]{102,204,238}{\small\verb;Y;}})^{2^{1}-1}\cdot f({\color[RGB]{204,187,68}{\small\verb;N;}})^{2^{1}-1}
\cdot
\frac{
\bigl(2\cdot 2^{1} -1 \bigr)!
}{
{\bigl(2^{1} - 1\bigr)!}^2
}
+{} \\&amp;\qquad
f({\color[RGB]{102,204,238}{\small\verb;Y;}})^{2^{2}-1}\cdot f({\color[RGB]{204,187,68}{\small\verb;N;}})^{2^{2}-1}
\cdot
\frac{
\bigl(2\cdot 2^{2} -1 \bigr)!
}{
{\bigl(2^{2} - 1\bigr)!}^2
}
\Biggr]
\\[2ex]
&amp;=
\frac{1}{4}
\Biggl[
\frac{1}{\sqrt{f({\color[RGB]{102,204,238}{\small\verb;Y;}})}}\cdot \frac{1}{\sqrt{f({\color[RGB]{204,187,68}{\small\verb;N;}})}}
\cdot \frac{1}{\pi}
+{} \\&amp;\qquad 1
\cdot \frac{1}{1}
+{} \\&amp;\qquad f({\color[RGB]{102,204,238}{\small\verb;Y;}})\cdot f({\color[RGB]{204,187,68}{\small\verb;N;}})
\cdot \frac{6}{1}
+{} \\&amp;\qquad f({\color[RGB]{102,204,238}{\small\verb;Y;}})^{3}\cdot f({\color[RGB]{204,187,68}{\small\verb;N;}})^{3}
\cdot \frac{5040}{36}
\Biggr]
\end{aligned}
\]</span></p>
<p>We can visualize this distribution with a generalized scatter plot (<a href="joint_probability.html#sec-repr-general-distr">§ &nbsp;<span>15.7</span></a>) of 100 frequency distributions, each represented by a line histogram (<a href="probability_distributions.html#sec-discr-prob-distr">§ &nbsp;<span>14.2</span></a>):</p>
<p><img src="samples_rocks.png" class="img-fluid" style="width:100.0%"></p>
<p>we see that all possible frequency distributions are considered by this belief distribution.</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="fa-solid fa-user-edit" aria-label="user-edit"></i> Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Calculate the formula above for these three frequency distributions:</p>
<ul>
<li><p><span class="math inline">\(f({\color[RGB]{102,204,238}{\small\verb;Y;}})=0.5\quad f({\color[RGB]{204,187,68}{\small\verb;N;}})=0.5\)</span></p></li>
<li><p><span class="math inline">\(f({\color[RGB]{102,204,238}{\small\verb;Y;}})=0.75\quad f({\color[RGB]{204,187,68}{\small\verb;N;}})=0.25\)</span></p></li>
<li><p><span class="math inline">\(f({\color[RGB]{102,204,238}{\small\verb;Y;}})=0.99\quad f({\color[RGB]{204,187,68}{\small\verb;N;}})=0.01\)</span></p></li>
</ul>
</div>
</div>
</section>
<section id="sec-joint-prob-dirichlet" class="level2 page-columns page-full" data-number="32.2">
<h2 data-number="32.2" class="anchored" data-anchor-id="sec-joint-prob-dirichlet"><span class="header-section-number">32.2</span> Joint probabilities about units with the Dirichlet-mixture distribution</h2>
<p>A mathematical advantage of the Dirichlet-mixture belief distribution is that some formulae where it enters can be computed exactly. The most important is the formula in de&nbsp;Finetti’s representation theorem (<a href="inference_about_freqs.html#sec-freq-not-known">§ &nbsp;<span>30.1</span></a>).</p>
<p>Take a sequence of observations for <span style="display:inline-block;"><span class="math inline">\(N+1\)</span></span> units, for which the variate <span style="display:inline-block;"><span class="math inline">\({\color[RGB]{68,119,170}Z}\)</span></span> is seen to have values <span style="display:inline-block;"><span class="math inline">\(\color[RGB]{68,119,170}z_1, z_2, \dotsc, z_{N+1}\)</span>.</span> Some or even all of these <span style="display:inline-block;"><span class="math inline">\(N+1\)</span></span> values might be identical; denote by <span style="display:inline-block;"><span class="math inline">\(\#{\color[RGB]{68,119,170}z}\)</span></span> the multiplicity with which value <span style="display:inline-block;"><span class="math inline">\({\color[RGB]{68,119,170}z}\)</span></span> occurs in the sequence. For instance, in the Mars-prospecting example, the sequence</p>
<p><span class="math display">\[
R_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_4\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}
\]</span></p>
<div class="page-columns page-full"><p>has <span style="display:inline-block;"><span class="math inline">\(N+1=4\)</span>,</span> <span style="display:inline-block;"><span class="math inline">\(\#{\color[RGB]{102,204,238}{\small\verb;Y;}}= 3\)</span>,</span> and <span style="display:inline-block;"><span class="math inline">\(\#{\color[RGB]{204,187,68}{\small\verb;N;}}= 1\)</span>,</span> whereas the sequence<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p><div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;Remember that the agent has exchangeable beliefs, so the units’ IDs don’t matter (<a href="exchangeable_probabilities.html#sec-exchaneable-distr">§ &nbsp;<span>28.3</span></a>)!</p></li></div></div>
<p><span class="math display">\[
R_{32}\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_{102}\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_{8}\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}
\]</span></p>
<p>has <span style="display:inline-block;"><span class="math inline">\(N+1=4\)</span>,</span> <span style="display:inline-block;"><span class="math inline">\(\#{\color[RGB]{102,204,238}{\small\verb;Y;}}= 0\)</span>,</span> and <span style="display:inline-block;"><span class="math inline">\(\#{\color[RGB]{204,187,68}{\small\verb;N;}}= 3\)</span>.</span></p>
<p>With the Dirichlet-mixture distribution we have the following general equality:</p>
<div class="column-body-outset-right">
<p><span class="math display">\[
\begin{aligned}
\mathrm{P}(
\color[RGB]{68,119,170}
Z_{N+1}\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}z_{N+1}
\mathbin{\mkern-0.5mu,\mkern-0.5mu}
\dotsb
Z_{1}\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}z_1
\color[RGB]{0,0,0}
\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D}
)
&amp;=
\int
f(\color[RGB]{68,119,170}Z_{N+1}\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}z_{N+1} \color[RGB]{0,0,0}) \cdot
\,\dotsb\, \cdot
f(\color[RGB]{68,119,170}Z_{1}\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}z_1 \color[RGB]{0,0,0}) \cdot
\mathrm{p}(F\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}\boldsymbol{f}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D})
\,\mathrm{d}\boldsymbol{f}
\\[2ex]
&amp;=
\frac{1}{1+k_{\text{max}}-k_{\text{min}}}
\sum_{k=k_{\text{min}}}^{k_{\text{max}}}
\frac{
\prod_{{\color[RGB]{68,119,170}z}} \bigl(2^{k} + \#{\color[RGB]{68,119,170}z}- 1\bigr)!
}{
\bigl(M\,2^{k} + N \bigr)!
}
\cdot
\frac{
\bigl(M\,2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^M
}
\end{aligned}
\]</span></p>
</div>
<p>As a concrete numerical example,</p>
<div class="column-body-outset-right">
<p><span class="math display">\[
\begin{aligned}
&amp;\mathrm{P}(
\underbracket[0.1ex]{R_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_4\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}}_{
\color[RGB]{187,187,187}N+1=4\quad \#{\small\verb;Y;}=3\quad \#{\small\verb;N;}=1
}
\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D}
)
\\
&amp;\qquad{}=
\frac{1}{1+2+1}
\sum_{k=-1}^{2}
\frac{
\bigl(2^{k} + {\color[RGB]{102,204,238}3} - 1\bigr)! \cdot
\bigl(2^{k} + {\color[RGB]{204,187,68}1} - 1\bigr)!
}{
\bigl(2\cdot 2^{k} + 3 \bigr)!
}
\cdot
\frac{
\bigl(2\cdot 2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^2
}
\\[1ex]
&amp;\qquad{}=
\boldsymbol{0.051 702 9}
\end{aligned}
\]</span></p>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="fa-solid fa-user-edit" aria-label="user-edit"></i> Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Using the formula above, calculate:</p>
<ul>
<li><p><span class="math inline">\(\mathrm{P}(R_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D})\)</span> ; does the result make sense?</p></li>
<li><p><span class="math inline">\(\mathrm{P}(R_{32}\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_{102}\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_{8}\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D})\)</span></p></li>
</ul>
</div>
</div>
</section>
<section id="sec-formulae-with-Dirmix" class="level2 page-columns page-full" data-number="32.3">
<h2 data-number="32.3" class="anchored" data-anchor-id="sec-formulae-with-Dirmix"><span class="header-section-number">32.3</span> Main inference formulae with the Dirichlet-mixture belief distribution</h2>
<p>Replacing the Dirichlet-mixture formula</p>
<p><span class="math display">\[
\mathrm{p}(F\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}\boldsymbol{f}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D}) =
\frac{1}{1+k_{\text{max}}-k_{\text{min}}}
\sum_{k}
\Biggl[\prod_{{\color[RGB]{68,119,170}z}} f({\color[RGB]{68,119,170}z})^{2^k-1} \Biggr]
\cdot
\frac{
\bigl(M\,2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^M
}
\]</span></p>
<p>in the theoretical inference formulae summarized in <a href="summary_formulae.html">chapter&nbsp;&nbsp;<span>31</span></a>, and simplifying the resulting expressions using some mathematical identities, we obtain the following concrete formulae:</p>
<div class="column-page-inset-right">
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Main formulae for some inference tasks under Dirichlet-mixture beliefs
</div>
</div>
<div class="callout-body-container callout-body">
<p>(<span style="display:inline-block;"><span class="math inline">\({\color[RGB]{68,119,170}Z}, {\color[RGB]{68,119,170}Y}, {\color[RGB]{68,119,170}X}\)</span></span> are each a single nominal variate or a collection thereof)</p>
<dl>
<dt>de&nbsp;Finetti’s representation</dt>
<dd>

</dd>
</dl>
<p><span class="math display">\[
\begin{aligned}
&amp;\mathrm{P}\bigl(
\color[RGB]{68,119,170}Z_{N+1} \mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}z_{N+1}
\mathbin{\mkern-0.5mu,\mkern-0.5mu}
Z_N \mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}z_N
\mathbin{\mkern-0.5mu,\mkern-0.5mu}
\dotsb \mathbin{\mkern-0.5mu,\mkern-0.5mu}
Z_1 \mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}z_1
\color[RGB]{0,0,0}\pmb{\nonscript\:\big\vert\nonscript\:\mathopen{}} \mathsfit{D}\bigr)
\\[2ex]
&amp;\qquad{}=
\frac{1}{1+k_{\text{max}}-k_{\text{min}}}
\sum_{k=k_{\text{min}}}^{k_{\text{max}}}
\frac{
\prod_{{\color[RGB]{68,119,170}z}} \bigl(2^{k} + {\color[RGB]{68,119,170}\#z} - 1\bigr)!
}{
\bigl(M\,2^{k} + N \bigr)!
}
\cdot
\frac{
\bigl(M\,2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^M
}
\end{aligned}
\]</span></p>
<p>or, in terms of predictand <span style="display:inline-block;"><span class="math inline">\({\color[RGB]{68,119,170}Y}\)</span></span> and predictors <span style="display:inline-block;"><span class="math inline">\({\color[RGB]{68,119,170}X}\)</span></span> variates:</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\mathrm{P}\bigl(
\color[RGB]{68,119,170}Y_{N+1} \mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}y_{N+1}
\mathbin{\mkern-0.5mu,\mkern-0.5mu}
X_{N+1} \mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}x_{N+1}
\mathbin{\mkern-0.5mu,\mkern-0.5mu}
\dotsb
\mathbin{\mkern-0.5mu,\mkern-0.5mu}
Y_{1} \mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}y_{1}
\mathbin{\mkern-0.5mu,\mkern-0.5mu}
X_{1} \mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}x_{1}
\color[RGB]{0,0,0}\pmb{\nonscript\:\big\vert\nonscript\:\mathopen{}} \mathsfit{D}\bigr)
\\[2ex]
&amp;\qquad{}=
\frac{1}{1+k_{\text{max}}-k_{\text{min}}}
\sum_{k=k_{\text{min}}}^{k_{\text{max}}}
\frac{
\prod_{\color[RGB]{68,119,170}y, x} \bigl(2^{k} + {\color[RGB]{68,119,170}\#(y,x)} - 1\bigr)!
}{
\bigl(M\,2^{k} + N \bigr)!
}
\cdot
\frac{
\bigl(M\,2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^M
}
\end{aligned}
\]</span></p>
<p>In the formula above, <span style="display:inline-block;"><span class="math inline">\(\color[RGB]{68,119,170}\#(y, x)\)</span></span> is the number of times the specific <em>pair</em> of values <span style="display:inline-block;"><span class="math inline">\(\color[RGB]{68,119,170}(y,x)\)</span></span> appears in the proposal side of the probability.</p>
<p><br>
</p>
<p><br>
</p>
<dl>
<dt><i class="fa-regular fa-star" aria-label="star"></i> Inferences about all variates <span class="math inline">\({\color[RGB]{68,119,170}Z}\)</span> of a new unit, given observed units</dt>
<dd>

</dd>
</dl>
<p><span class="math display">\[
\begin{aligned}
&amp;\mathrm{P}\bigl(
    \color[RGB]{238,102,119}Z_{N+1} \mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}z_{N+1}
\color[RGB]{0,0,0}\pmb{\nonscript\:\big\vert\nonscript\:\mathopen{}}
    \color[RGB]{34,136,51}Z_N \mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}z_N \mathbin{\mkern-0.5mu,\mkern-0.5mu}
    \dotsb \mathbin{\mkern-0.5mu,\mkern-0.5mu}
    Z_1 \mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}z_1
    \color[RGB]{0,0,0}\mathbin{\mkern-0.5mu,\mkern-0.5mu}\mathsfit{D}\bigr)
\\[2ex]
&amp;\qquad{}=
    \frac{\displaystyle{}\enspace
    \sum_{k=k_{\text{min}}}^{k_{\text{max}}}
\frac{
(2^{k} + {\color[RGB]{34,136,51}\# z_{N+1}} )
\cdot
\prod_{\color[RGB]{34,136,51}z} \bigl(2^{k} + {\color[RGB]{34,136,51}\# z} - 1\bigr)!
}{
\bigl(M\,2^{k} + N \bigr)!
}
\cdot
\frac{
\bigl(M\,2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^M
}
    \enspace{}}{\displaystyle{}\enspace
    \sum_{\color[RGB]{34,136,51}z^*}
    \sum_{k=k_{\text{min}}}^{k_{\text{max}}}
\frac{
(2^{k} + {\color[RGB]{34,136,51}\# z^*})
\cdot
\prod_{\color[RGB]{34,136,51}z} \bigl(2^{k} + {\color[RGB]{34,136,51}\# z} - 1\bigr)!
}{
\bigl(M\,2^{k} + N \bigr)!
}
\cdot
\frac{
\bigl(M\,2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^M
}
    \enspace{}}
\end{aligned}
\]</span></p>
<p><br>
</p>
<p><br>
</p>
<dl>
<dt><i class="fa-solid fa-star-half-alt" aria-label="star-half-alt"></i> Inferences about predictands <span class="math inline">\({\color[RGB]{68,119,170}Y}\)</span> of a new unit, given its predictors <span class="math inline">\({\color[RGB]{68,119,170}X}\)</span> and given both predictands &amp; predictors of observed units</dt>
<dd>

</dd>
</dl>
<p><span class="math display">\[
\begin{aligned}
    &amp;\mathrm{P}\bigl(
    \color[RGB]{238,102,119}Y_{N+1} \mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}y_{N+1}
\color[RGB]{0,0,0}\pmb{\nonscript\:\big\vert\nonscript\:\mathopen{}}
    \color[RGB]{34,136,51}X_{N+1} \mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}x_{N+1}\, \mathbin{\mkern-0.5mu,\mkern-0.5mu}\,
Y_N \mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}y_N \mathbin{\mkern-0.5mu,\mkern-0.5mu}X_N \mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}x_N \mathbin{\mkern-0.5mu,\mkern-0.5mu}
    \dotsb \mathbin{\mkern-0.5mu,\mkern-0.5mu}
    Y_1 \mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}y_1 \mathbin{\mkern-0.5mu,\mkern-0.5mu}X_1 \mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}x_1
    \color[RGB]{0,0,0}\mathbin{\mkern-0.5mu,\mkern-0.5mu}\mathsfit{D}\bigr)
    \\[2ex]
    &amp;\qquad\qquad\qquad{}=
    \frac{\displaystyle{}\enspace
    \sum_{k=k_{\text{min}}}^{k_{\text{max}}}
\frac{
\prod_{\color[RGB]{34,136,51}x}\bigl(2^{k} + {\color[RGB]{34,136,51}\#(y_{N+1}, x)}\bigr)
\cdot
\prod_{\color[RGB]{34,136,51}y}
\prod_{\color[RGB]{34,136,51}x}
\bigl(2^{k} + {\color[RGB]{34,136,51}\#(y, x)} - 1\bigr)!
}{
\bigl(M\,2^{k} + N \bigr)!
}
\cdot
\frac{
\bigl(M\,2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^M
}
    \enspace{}}{\displaystyle{}\enspace
    \sum_{\color[RGB]{34,136,51}y^*}
    \sum_{k=k_{\text{min}}}^{k_{\text{max}}}
\frac{
\prod_{\color[RGB]{34,136,51}x}\bigl(2^{k} + {\color[RGB]{34,136,51}\#(y^*, x)}\bigr)
\cdot
\prod_{\color[RGB]{34,136,51}y}
\prod_{\color[RGB]{34,136,51}x}
\bigl(2^{k} + {\color[RGB]{34,136,51}\#(y, x)} - 1\bigr)!
}{
\bigl(M\,2^{k} + N \bigr)!
}
\cdot
\frac{
\bigl(M\,2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^M
}
    \enspace{}}
\end{aligned}
\]</span></p>
<p><br>
</p>
<p>In the last two formulae, the counts <span style="display:inline-block;"><span class="math inline">\(\color[RGB]{34,136,51}\#z\)</span>,</span> <span style="display:inline-block;"><span class="math inline">\(\color[RGB]{34,136,51}\#(y,x)\)</span>,</span> and similar <span class="green"><strong>refer to the values present in the conditional</strong></span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="fa-solid fa-user-edit" aria-label="user-edit"></i> Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>The four formulae above look complicated. They do because they contain abbreviations (<span style="display:inline-block;">“<span class="math inline">\(\sum\)</span>”</span>, <span style="display:inline-block;">“<span class="math inline">\(\prod\)</span>”</span>) of sums or products of many terms. But once you have written down a couple of concrete examples, their meaning should be clear.</p>
<p>For the second formula, try to write it down for a concrete case in the Mars-prospecting scenario; say with <span style="display:inline-block;"><span class="math inline">\(N=2\)</span></span> and specific values for <span style="display:inline-block;"><span class="math inline">\(z_1, z_2, z_3\)</span>,</span> and verify that it is the correct expression of the more general formulae previously given. Use the property of the factorial</p>
<p><span class="math display">\[(a+1)! = (a+1) \cdot a!\]</span></p>
</div>
</div>
</section>
<section id="sec-dirmix-example1" class="level2 page-columns page-full" data-number="32.4">
<h2 data-number="32.4" class="anchored" data-anchor-id="sec-dirmix-example1"><span class="header-section-number">32.4</span> Example&nbsp;1: Forecast about one variate, given previous observations</h2>
<p>Let’s see a simple step-by-step application of the formulae in the Mars-prospecting scenario. In this task there are no predictors and only one predictand variate <span style="display:inline-block;"><span class="math inline">\(R\)</span>:</span> the presence of haematite. The agent observes the value of this variate in several rocks, and try to forecast its value in a new rock.</p>
<p>The agent has exchangeable beliefs represented by a Dirichlet-mixture distribution. The variate of the population of interest has two possible values, so in the formulae above we have&nbsp;&nbsp;<span style="display:inline-block;"><span class="math inline">\(k_{\text{min}}=-1\)</span>,</span> <span style="display:inline-block;"><span class="math inline">\(k_{\text{max}}=2\)</span>&nbsp;&nbsp;(</span><a href="inference_about_freqs.html#sec-prob-for-freqs">§ &nbsp;<span>30.4</span></a>).</p>
<p>The agent has collected three rocks, and upon examination two of them contain haematite, one doesn’t. The agent’s data are therefore</p>
<p><span class="math display">\[R_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\]</span></p>
<p>(remember that it doesn’t matter how we label the rocks, because the agent’s beliefs are exchangeable).</p>
<p>What probability should the agent give to finding haematite in a newly collected rock? That is, what value should it assign to</p>
<p><span class="math display">\[\mathrm{P}(R_4\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\nonscript\:\vert\nonscript\:\mathopen{} R_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}\mathsfit{D}) \ ?\]</span></p>
<p>There are different but logically equivalent ways of breaking down this calculation into steps. They also correspond to different ways of calculating the mathematical formulae. Here we examine one possibility.</p>
<p><br>
</p>
<p><span class="green"><i class="fa-solid fa-1" aria-label="1"></i> <i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i></span>&nbsp;&nbsp;&nbsp;For the computation of the probability for <span style="display:inline-block;"><span class="math inline">\(R_4\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\)</span></span> we need to consider all alternative hypotheses. In this case there are only two alternatives, including the one of interest:</p>
<p><span class="math display">\[R_4\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\qquad R_4\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\]</span></p>
<p><br>
</p>
<p><span class="green"><i class="fa-solid fa-2" aria-label="2"></i> <i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i></span>&nbsp;&nbsp;&nbsp;We need to calculate the joint probabilities for the agent’s data (about the three previous rocks) <code>and</code> each hypothesis in turn. In the present case, they are the two joint probabilities</p>
<p><span class="math display">\[
\begin{aligned}
\mathrm{P}(R_4\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\, \mathbin{\mkern-0.5mu,\mkern-0.5mu}\, R_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D})
\\[1ex]
\mathrm{P}(R_4\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\, \mathbin{\mkern-0.5mu,\mkern-0.5mu}\, R_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D})
\end{aligned}
\]</span></p>
<p>These probabilities will appear, summed together, in the denominator of a final fraction; whereas the probability containing the hypothesis of interest will appear, by itself, in the numerator.</p>
<div class="column-body-outset-right">
<p><span class="green"><i class="fa-solid fa-2" aria-label="2"></i>a <i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i></span>&nbsp;&nbsp;In the first joint probability, <span style="display:inline-block;"><span class="math inline">\({\color[RGB]{102,204,238}{\small\verb;Y;}}\)</span></span> appears thrice and <span style="display:inline-block;"><span class="math inline">\({\color[RGB]{204,187,68}{\small\verb;N;}}\)</span></span> appears once, so</p>
<p><span class="math display">\[\#{\color[RGB]{102,204,238}{\small\verb;Y;}}= 3 \qquad \#{\color[RGB]{204,187,68}{\small\verb;N;}}= 1 \qquad \text{\color[RGB]{119,119,119}\small total} = {\color[RGB]{119,119,119}4}\]</span></p>
<p>The de&nbsp;Finetti representation formula then gives</p>
<p><span class="math display">\[\begin{aligned}
&amp;\mathrm{P}(R_4\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\, \mathbin{\mkern-0.5mu,\mkern-0.5mu}\, R_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D})
\\[1ex]
&amp;\qquad{}=
\frac{1+2-1}
\sum_{k=-1}^{2}
\frac{
\bigl(2^{k} + {\color[RGB]{102,204,238}3} - 1\bigr)! \cdot
\bigl(2^{k} + {\color[RGB]{204,187,68}1} - 1\bigr)!
}{
\bigl(2\cdot 2^{k} + {\color[RGB]{119,119,119}4} -1 \bigr)!
}
\cdot
\frac{
\bigl(2\cdot 2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^2
}
\\[1ex]
&amp;\qquad{}=
\boldsymbol{0.051 702 9}
\end{aligned}
\]</span></p>
<p><span class="green"><i class="fa-solid fa-2" aria-label="2"></i>b <i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i></span>&nbsp;&nbsp;In the second joint probability, <span style="display:inline-block;"><span class="math inline">\({\color[RGB]{102,204,238}{\small\verb;Y;}}\)</span></span> appears twice and <span style="display:inline-block;"><span class="math inline">\({\color[RGB]{204,187,68}{\small\verb;N;}}\)</span></span> appears twice, so</p>
<p><span class="math display">\[\#{\color[RGB]{102,204,238}{\small\verb;Y;}}= 2 \qquad \#{\color[RGB]{204,187,68}{\small\verb;N;}}= 2 \qquad \text{\color[RGB]{119,119,119}\small total} = {\color[RGB]{119,119,119}4}\]</span></p>
<p>We find</p>
<p><span class="math display">\[\begin{aligned}
&amp;\mathrm{P}(R_4\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\, \mathbin{\mkern-0.5mu,\mkern-0.5mu}\, R_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D})
\\[1ex]
&amp;\qquad{}=
\frac{1}{4}
\sum_{k=-1}^{2}
\frac{
\bigl(2^{k} + {\color[RGB]{102,204,238}2} - 1\bigr)! \cdot
\bigl(2^{k} + {\color[RGB]{204,187,68}2} - 1\bigr)!
}{
\bigl(2\cdot 2^{k} + {\color[RGB]{119,119,119}4} -1 \bigr)!
}
\cdot
\frac{
\bigl(2\cdot 2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^2
}
\\[1ex]
&amp;\qquad{}=
\boldsymbol{0.037 533 3}
\end{aligned}
\]</span></p>
</div>
<p><br>
</p>
<p><span class="green"><i class="fa-solid fa-3" aria-label="3"></i> <i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i></span>&nbsp;&nbsp;&nbsp;The probability for the hypothesis of interest is given by the fraction</p>
<div class="column-page-inset-right">
<p><span class="math display">\[
\begin{aligned}
&amp;\mathrm{P}(R_4\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\nonscript\:\vert\nonscript\:\mathopen{} R_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}\mathsfit{D})
\\[1ex]
&amp;\qquad{}=
\frac{
\mathrm{P}(R_4\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\, \mathbin{\mkern-0.5mu,\mkern-0.5mu}\, R_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D})
}{
\mathrm{P}(R_4\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\, \mathbin{\mkern-0.5mu,\mkern-0.5mu}\, R_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D}) +
\mathrm{P}(R_4\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\, \mathbin{\mkern-0.5mu,\mkern-0.5mu}\, R_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{102,204,238}{\small\verb;Y;}}\mathbin{\mkern-0.5mu,\mkern-0.5mu}R_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\color[RGB]{204,187,68}{\small\verb;N;}}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D})
}
\\[1ex]
&amp;\qquad{}=
\frac{0.0517029}{0.0517029 + 0.037 533 3}
\\[1ex]
&amp;\qquad{}=
\boldsymbol{57.94\%}
\end{aligned}
\]</span></p>
</div>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="fa-solid fa-user-edit" aria-label="user-edit"></i> Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>The inference problem above has some analogy with coin tossing: there’s just one, binary, variate. This agent could have been used to make forecasts about coin tosses.</p>
<p>Consider the result above from the point of view of this analogy. Let’s say that <span style="display:inline-block;"><span class="math inline">\({\color[RGB]{102,204,238}{\small\verb;Y;}}\)</span></span> would be “heads”, and <span style="display:inline-block;"><span class="math inline">\({\color[RGB]{204,187,68}{\small\verb;N;}}\)</span></span> “tails”. Having observed four coin tosses, with three heads and one tail, the agent is giving a 58% probability for heads at the next toss.</p>
<ul>
<li><p>Do you consider this probability reasonable? Why?</p></li>
<li><p>In which different coin-tossing circumstances would you consider this probability reasonable (given the same previous observation data)?</p></li>
</ul>
</div>
</div>
</section>
<section id="sec-dirmix-example2" class="level2 page-columns page-full" data-number="32.5">
<h2 data-number="32.5" class="anchored" data-anchor-id="sec-dirmix-example2"><span class="header-section-number">32.5</span> Example&nbsp;2: Forecast about one predictand, given predictor and previous observations</h2>
<p>Let’s go back to the hospital scenario of <a href="conditional_probability.html#sec-conditional-joint-general">§ &nbsp;<span>17.4</span></a>. The units are patients coming into a hospital. The population is characterized by two nominal variates:</p>
<ul>
<li>the patient’s transportation mean <span class="math inline">\(T\)</span> at arrival, with domain <span class="math inline">\(\set{{\small\verb;ambulance;}, {\small\verb;helicopter;}, {\small\verb;other;}}\)</span></li>
<li>the patient’s need of urgent care <span class="math inline">\(U\)</span>, with domain <span class="math inline">\(\set{{\small\verb;urgent;}, {\small\verb;non-urgent;}}\)</span></li>
</ul>
<p>The combined variate <span style="display:inline-block;"><span class="math inline">\((U \mathbin{\mkern-0.5mu,\mkern-0.5mu}T)\)</span></span> has <span style="display:inline-block;"><span class="math inline">\(M = 2\cdot 3 = 6\)</span></span> possible values, so we have parameters <span style="display:inline-block;"><span class="math inline">\(k_{\text{min}}=-3\)</span></span> and <span style="display:inline-block;"><span class="math inline">\(k_{\text{max}}=2\)</span>.</span></p>
<p>The agent’s task is to forecast whether the next incoming patient will require urgent care or not (<span style="display:inline-block;"><span class="math inline">\(U\)</span>),</span> given information about the patient’s transportation (<span style="display:inline-block;"><span class="math inline">\(T\)</span>).</span> So <span style="display:inline-block;"><span class="math inline">\(U\)</span></span> is the predictand variate, <span style="display:inline-block;"><span class="math inline">\(T\)</span></span> the predictor variate.</p>
<p>At the moment the agent has a complete record of two previous patients:</p>
<ul>
<li><span class="math inline">\(U_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\)</span></li>
<li><span class="math inline">\(U_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;other;}\)</span></li>
</ul>
<p>A third patient is incoming by ambulance:</p>
<ul>
<li><span class="math inline">\(T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\)</span></li>
</ul>
<p>What is the probability that this patient requires urgent care?</p>
<section id="initial-belief" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="initial-belief">Initial belief</h4>
<p>First let’s get a glimpse of the agent’s forecast if it were given <em>no</em> information about previous patients. We therefore want to calculate the probability</p>
<p><span class="math display">\[\mathrm{P}(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\nonscript\:\vert\nonscript\:\mathopen{} T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}\mathsfit{D})\]</span></p>
<p><br>
</p>
<p><span class="green"><i class="fa-solid fa-1" aria-label="1"></i> <i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i></span>&nbsp;&nbsp;&nbsp;The hypotheses are <span style="display:inline-block;"><span class="math inline">\(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\)</span></span> and <span style="display:inline-block;"><span class="math inline">\(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\)</span></span></p>
<p><br>
</p>
<p><span class="green"><i class="fa-solid fa-2" aria-label="2"></i> <i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i></span>&nbsp;&nbsp;&nbsp;The joint probabilities for the hypotheses and previous data, since there’s no information about previous patients, are simply</p>
<div class="column-body-outset-right">
<p><span class="math display">\[
\mathrm{P}(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D})
\qquad
\mathrm{P}(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D})
\]</span></p>
</div>
<p><br>
</p>
<p><span class="green"><i class="fa-solid fa-2" aria-label="2"></i>a <i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i></span>&nbsp;&nbsp;In the first joint probability above the value pair <span style="display:inline-block;"><span class="math inline">\((U\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;})\)</span></span> appears once, and the remaining five pairs appear zero times:</p>
<div class="column-body-outset-right">
<p><span class="math display">\[\#({\small\verb;urgent;}, {\small\verb;ambulance;}) = {\color[RGB]{102,204,238}1} \qquad\text{\small five others }\#(\dotsc,\dotsc) = {\color[RGB]{204,187,68}0}
\qquad \text{\color[RGB]{119,119,119}\small total} = {\color[RGB]{119,119,119}1}\]</span></p>
</div>
<p>The de&nbsp;Finetti formula gives</p>
<div class="column-page-inset-right">
<p><span class="math display">\[
\begin{aligned}
&amp;\mathrm{P}(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D})
\\[2ex]
&amp;\qquad{}=
\frac{1}{1+2+3}
\sum_{k=-3}^{2}
\frac{
\bigl(2^{k} + {\color[RGB]{102,204,238}1} - 1\bigr)! \cdot
\underbracket[0.1ex]{\bigl(2^{k} + {\color[RGB]{204,187,68}0} - 1\bigr)! \cdot
\,\dotsb\, \cdot
\bigl(2^{k} + {\color[RGB]{204,187,68}0} - 1\bigr)!}_{\text{\color[RGB]{187,187,187}five factors}}
}{
\bigl(6\cdot 2^{k} + {\color[RGB]{119,119,119}1} -1 \bigr)!
}
\cdot
\frac{
\bigl(6\cdot 2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^6
}
\\[1ex]
&amp;\qquad{}=
\boldsymbol{1/6}
\end{aligned}
\]</span></p>
</div>
<p><br>
</p>
<p><span class="green"><i class="fa-solid fa-2" aria-label="2"></i>b <i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i></span>&nbsp;&nbsp;In the second joint probability above the value pair <span style="display:inline-block;"><span class="math inline">\((U\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;})\)</span></span> appears once, and the remaining five pairs appear zero times:</p>
<div class="column-body-outset-right">
<p><span class="math display">\[\#({\small\verb;non-urgent;}, {\small\verb;ambulance;}) = {\color[RGB]{102,204,238}1} \qquad\text{\small five others }\#(\dotsc,\dotsc) = {\color[RGB]{204,187,68}0}
\qquad \text{\color[RGB]{119,119,119}\small total} = {\color[RGB]{119,119,119}1}\]</span></p>
</div>
<p>The de&nbsp;Finetti formula gives an identical result as before:</p>
<div class="column-page-inset-right">
<p><span class="math display">\[
\begin{aligned}
&amp;\mathrm{P}(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D})
\\[2ex]
&amp;\qquad{}=
\frac{1}{1+2+3}
\sum_{k=-3}^{2}
\frac{
\bigl(2^{k} + {\color[RGB]{102,204,238}1} - 1\bigr)! \cdot
\underbracket[0.1ex]{\bigl(2^{k} + {\color[RGB]{204,187,68}0} - 1\bigr)! \cdot
\,\dotsb\, \cdot
\bigl(2^{k} + {\color[RGB]{204,187,68}0} - 1\bigr)!}_{\text{\color[RGB]{187,187,187}five factors}}
}{
\bigl(6\cdot 2^{k} + {\color[RGB]{119,119,119}1} -1 \bigr)!
}
\cdot
\frac{
\bigl(6\cdot 2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^6
}
\\[1ex]
&amp;\qquad{}=
\boldsymbol{1/6}
\end{aligned}
\]</span></p>
</div>
<p><br>
</p>
<p><span class="green"><i class="fa-solid fa-3" aria-label="3"></i> <i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i></span>&nbsp;&nbsp;&nbsp;The probability that this incoming patient is urgent is then</p>
<div class="column-page-inset-right">
<p><span class="math display">\[
\begin{aligned}
&amp;
\mathrm{P}(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\nonscript\:\vert\nonscript\:\mathopen{} T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}\mathsfit{D})
\\[1ex]
&amp;\qquad{}=
\frac{
\mathrm{P}(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D})
}{
\mathrm{P}(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D})
+
\mathrm{P}(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\nonscript\:\vert\nonscript\:\mathopen{} \mathsfit{D})
}
\\[1ex]
&amp;\qquad{}=
\frac{1/6 }{1/6 + 1/6}
\\[1ex]
&amp;\qquad{}=
\boldsymbol{50\%}
\end{aligned}
\]</span></p>
</div>
<p><br>
</p>
<p>This result shows that the agent’s background information says that, a priori, urgent and non-urgent patients are equally plausible. This is a characteristic of the particular Dirichlet-mixture belief distribution we are using. It would actually be possible to slightly modify it so as to give a-priori different probabilities for the <span style="display:inline-block;"><span class="math inline">\({\small\verb;urgent;}\)</span></span> and <span style="display:inline-block;"><span class="math inline">\({\small\verb;non-urgent;}\)</span></span> values, but we shall not pursue this possibility here.</p>
<p><br>
</p>
</section>
<section id="forecast-after-learning" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="forecast-after-learning">Forecast after learning</h4>
<p>Now let’s do an analogous calculation, but taking into account the information about the previous two patients. We therefore want to calculate the probability</p>
<div class="column-page-right">
<p><span class="math display">\[\mathrm{P}(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\nonscript\:\vert\nonscript\:\mathopen{} T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
U_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;other;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
U_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
\mathsfit{D})
\]</span></p>
</div>
<p><br>
</p>
<p><span class="green"><i class="fa-solid fa-1" aria-label="1"></i> <i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i></span>&nbsp;&nbsp;&nbsp;The hypotheses are again <span style="display:inline-block;"><span class="math inline">\(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\)</span></span> and <span style="display:inline-block;"><span class="math inline">\(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\)</span></span></p>
<p><br>
</p>
<p><span class="green"><i class="fa-solid fa-2" aria-label="2"></i> <i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i></span>&nbsp;&nbsp;&nbsp;The joint probabilities for the hypotheses and known data are</p>
<div class="column-page-right">
<p><span class="math display">\[
\begin{aligned}
&amp;\mathrm{P}(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
U_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;other;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
U_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\nonscript\:\vert\nonscript\:\mathopen{}
\mathsfit{D})
\\[1ex]
&amp;\mathrm{P}(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
U_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;other;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
U_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\nonscript\:\vert\nonscript\:\mathopen{}
\mathsfit{D})
\end{aligned}
\]</span></p>
</div>
<p><br>
</p>
<p><span class="green"><i class="fa-solid fa-2" aria-label="2"></i>a <i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i></span>&nbsp;&nbsp;In the first joint probability above we have the following counts:</p>
<div class="column-page-right">
<p><span class="math display">\[
\#({\small\verb;urgent;}, {\small\verb;ambulance;}) = {\color[RGB]{68,119,170}2} \quad
\#({\small\verb;non-urgent;}, {\small\verb;other;}) = {\color[RGB]{102,204,238}1} \quad
\text{\small four others }\#(\dotsc,\dotsc) = {\color[RGB]{204,187,68}0}
\quad \text{\color[RGB]{119,119,119}\small total} = {\color[RGB]{119,119,119}3}\]</span></p>
</div>
<p>and therefore</p>
<div class="column-page-right">
<p><span class="math display">\[
\begin{aligned}
&amp;\mathrm{P}(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
U_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;other;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
U_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\nonscript\:\vert\nonscript\:\mathopen{}
\mathsfit{D})
\\[2ex]
&amp;\qquad{}=
\frac{1}{6}
\sum_{k=-3}^{2}
\frac{
\bigl(2^{k} + {\color[RGB]{68,119,170}2} - 1\bigr)! \cdot
\bigl(2^{k} + {\color[RGB]{102,204,238}1} - 1\bigr)! \cdot
\underbracket[0.1ex]{\bigl(2^{k} + {\color[RGB]{204,187,68}0} - 1\bigr)! \cdot
\,\dotsb\, \cdot
\bigl(2^{k} + {\color[RGB]{204,187,68}0} - 1\bigr)!}_{\text{\color[RGB]{187,187,187}four factors}}
}{
\bigl(6\cdot 2^{k} + {\color[RGB]{119,119,119}3} -1 \bigr)!
}
\cdot
\frac{
\bigl(6\cdot 2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^6
}
\\[1ex]
&amp;\qquad{}=
\boldsymbol{0.005 607 93}
\end{aligned}
\]</span></p>
</div>
<p><br>
</p>
<p><span class="green"><i class="fa-solid fa-2" aria-label="2"></i>b <i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i></span>&nbsp;&nbsp;Second joint probability:</p>
<div class="column-page-right">
<p><span class="math display">\[
\begin{gathered}
\#({\small\verb;urgent;}, {\small\verb;ambulance;}) = {\color[RGB]{102,204,238}1} \qquad
\#({\small\verb;non-urgent;}, {\small\verb;ambulance;}) = {\color[RGB]{102,204,238}1} \qquad
\#({\small\verb;non-urgent;}, {\small\verb;other;}) = {\color[RGB]{102,204,238}1}
\\[1ex]
\text{\small three others }\#(\dotsc,\dotsc) = {\color[RGB]{204,187,68}0}
\qquad \text{\color[RGB]{119,119,119}\small total} = {\color[RGB]{119,119,119}3}
\end{gathered}
\]</span></p>
</div>
<p>and therefore</p>
<div class="column-page-right">
<p><span class="math display">\[
\begin{aligned}
&amp;\mathrm{P}(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
U_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;other;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
U_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\nonscript\:\vert\nonscript\:\mathopen{}
\mathsfit{D})
\\[2ex]
&amp;\qquad{}=
\frac{1}{6}
\sum_{k=-3}^{2}
\frac{
\underbracket[0.1ex]{
\bigl(2^{k} + {\color[RGB]{102,204,238}1} - 1\bigr)!
\cdot\,\dotsb\, \cdot
\bigl(2^{k} + {\color[RGB]{102,204,238}1} - 1\bigr)!
}_{\text{\color[RGB]{187,187,187}three factors}}
\cdot
\underbracket[0.1ex]{\bigl(2^{k} + {\color[RGB]{204,187,68}0} - 1\bigr)! \cdot
\,\dotsb\, \cdot
\bigl(2^{k} + {\color[RGB]{204,187,68}0} - 1\bigr)!}_{\text{\color[RGB]{187,187,187}three factors}}
}{
\bigl(6\cdot 2^{k} + {\color[RGB]{119,119,119}3} -1 \bigr)!
}
\cdot
\frac{
\bigl(6\cdot 2^{k} -1 \bigr)!
}{
{\bigl(2^{k} - 1\bigr)!}^6
}
\\[1ex]
&amp;\qquad{}=
\boldsymbol{0.002 426 12}
\end{aligned}
\]</span></p>
</div>
<p><br>
</p>
<p><span class="green"><i class="fa-solid fa-3" aria-label="3"></i> <i class="fa-solid fa-hand-point-right" aria-label="hand-point-right"></i></span>&nbsp;&nbsp;&nbsp;The probability that the third incoming patient is urgent is</p>
<div class="column-page-inset-right">
<p><span class="math display">\[
\begin{aligned}
&amp;
\mathrm{P}(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\nonscript\:\vert\nonscript\:\mathopen{} T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
U_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;other;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
U_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
\mathsfit{D})
\\[1ex]
&amp;\qquad{}=
\frac{0.005 607 93}{0.005 607 93 + 0.002 426 12}
\\[1ex]
&amp;\qquad{}=
\boldsymbol{69.80\%}
\end{aligned}
\]</span></p>
</div>
<p>The agent has learned an association between <span style="display:inline-block;"><span class="math inline">\({\small\verb;ambulance;}\)</span></span> and <span style="display:inline-block;"><span class="math inline">\({\small\verb;urgent;}\)</span></span> from the first patient.</p>
<p><br>
</p>
<div class="column-page-inset-right">
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="fa-solid fa-user-edit" aria-label="user-edit"></i> Exercises
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Do the inverse inference, using urgency <span style="display:inline-block;"><span class="math inline">\(U\)</span></span> as predictor, and transportation <span style="display:inline-block;"><span class="math inline">\(T\)</span></span> as predictand. That is, calculate the probability</p>
<p><span class="math display">\[\mathrm{P}( T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\nonscript\:\vert\nonscript\:\mathopen{} U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
U_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;other;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
U_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
\mathsfit{D})\]</span></p></li>
<li><p>Imagine that the urgency variate for the first patient, <span style="display:inline-block;"><span class="math inline">\(U_1\)</span>,</span> is not known (missing data). Using the formula for marginalization (see <a href="beyond-ML.html#sec-underlying-distribution">§ &nbsp;<span>27.4</span></a>), calculate the corresponding probability</p>
<p><span class="math display">\[\mathrm{P}(U_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;urgent;}\nonscript\:\vert\nonscript\:\mathopen{} T_3\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
U_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;non-urgent;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}T_2\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;other;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
T_1\mathclose{}\mathord{\nonscript\mkern 0mu\textrm{\small=}\nonscript\mkern 0mu}\mathopen{}{\small\verb;ambulance;}\mathbin{\mkern-0.5mu,\mkern-0.5mu}
\mathsfit{D})\]</span></p></li>
<li><p>Make similar kinds of inferences, freely trying other combinations of information about the two previous patients.</p></li>
<li><p>Do the same, but with three previous patients instead of two.</p></li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="sec-critique-dirmix" class="level2" data-number="32.6">
<h2 data-number="32.6" class="anchored" data-anchor-id="sec-critique-dirmix"><span class="header-section-number">32.6</span> When is the Dirichlet-mixture belief distribution appropriate?</h2>
<p>The two examples above reveal some characteristics of an agent based on the Dirichlet-mixture belief distribution:</p>
<ul>
<li><p>In absence of previous data, it assigns uniform probability distributions to any variate.</p></li>
<li><p>It is somewhat “eager” to learn from previous examples: its probabilities vary appreciably even with only few observations.</p></li>
</ul>
<p>There are also other subtle characteristics connected to these, which we won’t discuss here.</p>
<p>These characteristics can be appropriate to some inference tasks, but not to others. It is again a matter of <em>background information</em> about the task one wants to solve.</p>
<p>The background information implicit in the Dirichlet-mixture belief distribution can be reasonable in situations where:</p>
<ul>
<li><p>There is very little information about the physics or science behind the variates and population, so one is willing to give a lot of weight to observed data. Contrast this with the coin-tossing scenario, where our physics knowledge about coin tosses make us appreciably change our probabilities only after a large number of observations.</p></li>
<li><p>A large number of previous observations is available, “large” relative to the domain size <span style="display:inline-block;"><span class="math inline">\(M\)</span></span> of the total variate <span style="display:inline-block;"><span class="math inline">\(Z\)</span>.</span></p></li>
</ul>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<i class="fa-solid fa-book" aria-label="book"></i> Study reading (again)
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://hvl.instructure.com/courses/25074/modules/items/661553"><em>Dynamical Bias in the Coin Toss</em></a>. </p>
</div>
</div>
<p>It is possible to modify the Dirichlet-mixture belief distribution in order to alter the characteristics above. Some modifications can assign more a-priori plausibility to some variate values than others, or make the initial belief less affected by observed data.</p>
<p>These possibilities should remind us about the importance of assessing and specifying appropriate background information. No matter the amount of data, what the data eventually “tell” us acquires meaning only against the background information from which they are observed.</p>
<hr>
<p>In the next chapter we discuss the code implementation of the formulae for the Dirichlet-mixture agent.</p>


</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./summary_formulae.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title"><span class="green">Final inference formulae</span></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./prototype_code.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title"><span class="red">Code and computations</span></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>